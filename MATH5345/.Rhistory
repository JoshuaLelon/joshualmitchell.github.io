lower # -7.459577
upper <- B_1_hat + (2.145 * SE)
upper # -7.348423
# So, the CI is: (-7.459577, -7.348423)
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.7data.txt", header=T)
data
x = data$hydro
y = data$purity
mean(x)
mean(y)
plot(y~x, type="n") # Prepare the plot (i.e. make a blank graph)
m = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
##########################
# a) Fit Linear Model
##########################
m # B_0 = 77.86, B_1 = 11.80
# So y_hat = 77.86 + 11.80x
pred = predict(m, new=data.frame(x = x), interval="conf") # Predict y for those random x
pred
##########################
# b) Test the hypothesis that H_0 : B_1 = 0, where as H_a : B_1 /= 0
##########################
B_1_hat <- 11.80
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x * mean(x))^2)
S_xx # 40.59437
SS_res <- SS_T - B_1_hat * S_xy
n <- 20
MS_res <- SS_res / (n - 2)
MS_res #12.93596
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # 20.90333
##########################
# c) Calculate R^2
##########################
summary(m)$r.squared
# add lines for confidence limits ad regression line, add points
# This "pred" is a matrix with 3 columns: fit, lwr (lower), upr (upper)
lines(new.x, pred[, "fit"], lwd=2)
lines(new.x, pred[, "lwr"], lty=3)
lines(new.x, pred[, "upr"], lty=3)
points(x, y, pch=16, col="steelblue")
### Alternative: Plot Confidence Band:
plot(y~x, type="n")
polygon(c(new.x, rev(new.x)), c(pred[, "lwr"], rev(pred[, "upr"])), border=NA, col=blues9[3])
lines(new.x, pred[,"fit"], lwd=2, col=blues9[8])
points(x, y, pch=16)
box()
dim(prop)
ym <- prop$ShearStrength.y
xm <- prop$Propellant.Age.x
prop.lm <- lm(ym~xm) # Fit a simple regression model
summary(prop.lm)
anova(prop.lm)
par(mfrow=c(2,2)) # par means parameter setting
plot(prop.lm) # plot(y~x) is the same thing as plot(x, y)
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.7data.txt", header=T)
data
x = data$hydro
y = data$purity
mean(x)
mean(y)
plot(y~x, type="n") # Prepare the plot (i.e. make a blank graph)
m = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
##########################
# a) Fit Linear Model
##########################
m # B_0 = 77.86, B_1 = 11.80
# So y_hat = 77.86 + 11.80x
pred = predict(m, new=data.frame(x = x), interval="conf") # Predict y for those random x
pred
##########################
# b) Test the hypothesis that H_0 : B_1 = 0, where as H_a : B_1 /= 0
##########################
B_1_hat <- 11.80
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x - mean(x))^2)
S_xx # 40.59437
SS_res <- SS_T - B_1_hat * S_xy
n <- 20
MS_res <- SS_res / (n - 2)
MS_res #12.93596
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # 20.90333
summary(m)$r.squared
lower <- B_1_hat - (2.101 * SE)
lower # -7.459577
upper <- B_1_hat + (2.101 * SE)
upper # -7.348423
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.7data.txt", header=T)
data
x = data$hydro
y = data$purity
##########################
# a) Fit Linear Model
##########################
m = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
m # B_0 = 77.86, B_1 = 11.80
# So y_hat = 77.86 + 11.80x
##########################
# b) Test the hypothesis that H_0 : B_1 = 0, where as H_a : B_1 /= 0
##########################
B_1_hat <- 11.80
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x - mean(x))^2)
S_xx # 1.064975
SS_res <- SS_T - B_1_hat * S_xy
n <- 20
MS_res <- SS_res / (n - 2)
MS_res #12.93596
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # 3.38573
# We reject H_0 if |t_0| > t_alpha/2, n-2.
# 3.38612 > t_alpha/2, n-2
# 3.38612 > 2.101
# Therefore, reject H_0
##########################
# c) Calculate R^2
##########################
summary(m)$r.squared # 0.3891224
##########################
# d) Find a 95% Confidence Interval on the slope, B_1
##########################
# A 100(1 - alpha)% CI on B_1 is:
# B_1_hat - t_alpha/2_n-2 * se(B_1_hat) <= B_1 <= B_1_hat + t_alpha/2_n-2 * se(B_1_hat)
lower <- B_1_hat - (2.101 * SE)
lower # 4.478
upper <- B_1_hat + (2.101 * SE)
upper # 19.12
# So, the CI is: (4.478, 19.12)
##########################
# e) Find a 95% Confidence Interval on y | x_0 where x_0: x = 1
##########################
# Let dif = sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
# A 100(1 - alpha)% CI on y | x_0 where x_0 : x = 1 is:
# y_hat - dif <= y <= y_hat + dif
x_0 <- 1
B_0_hat <- 77.8633
y_hat <- B_0_hat + B_1_hat * x_0
dif <- sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
lower <- B_1_hat - dif
lower # 4.478
upper <- B_1_hat + dif
upper # 19.12
# So, the CI is: (4.478, 19.12)
dif
?print
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.7data.txt", header=T)
data
x = data$hydro
y = data$purity
##########################
# a) Fit Linear Model
##########################
m = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
m # B_0 = 77.86, B_1 = 11.80
# So y_hat = 77.86 + 11.80x
##########################
# b) Test the hypothesis that H_0 : B_1 = 0, where as H_a : B_1 /= 0
##########################
B_1_hat <- 11.80
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x - mean(x))^2)
S_xx # 1.064975
SS_res <- SS_T - B_1_hat * S_xy
n <- 20
MS_res <- SS_res / (n - 2)
MS_res #12.93596
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # 3.38573
# We reject H_0 if |t_0| > t_alpha/2, n-2.
# 3.38612 > t_alpha/2, n-2
# 3.38612 > 2.101
# Therefore, reject H_0
##########################
# c) Calculate R^2
##########################
summary(m)$r.squared # 0.3891224
##########################
# d) Find a 95% Confidence Interval on the slope, B_1
##########################
# A 100(1 - alpha)% CI on B_1 is:
# B_1_hat - t_alpha/2_n-2 * se(B_1_hat) <= B_1 <= B_1_hat + t_alpha/2_n-2 * se(B_1_hat)
lower <- B_1_hat - (2.101 * SE)
lower # 4.478
upper <- B_1_hat + (2.101 * SE)
upper # 19.12
# So, the CI is: (4.478, 19.12)
##########################
# e) Find a 95% Confidence Interval on y | x_0 where x_0: x = 1
##########################
# Let dif = sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
# A 100(1 - alpha)% CI on y | x_0 where x_0 : x = 1 is:
# y_hat - dif <= y <= y_hat + dif
x_0 <- 1
B_0_hat <- 77.8633
y_hat <- B_0_hat + B_1_hat * x_0
dif <- sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
dif
lower <- y_hat - dif
lower # 10.77464
upper <- y_hat + dif
upper # 12.82536
# So, the CI is: (10.77464, 12.82536)
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.7data.txt", header=T)
data
x = data$hydro
y = data$purity
##########################
# a) Fit Linear Model
##########################
m = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
m # B_0 = 77.86, B_1 = 11.80
# So y_hat = 77.86 + 11.80x
##########################
# b) Test the hypothesis that H_0 : B_1 = 0, where as H_a : B_1 /= 0
##########################
B_1_hat <- 11.80
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x - mean(x))^2)
S_xx # 1.064975
SS_res <- SS_T - B_1_hat * S_xy
n <- 20
MS_res <- SS_res / (n - 2)
MS_res #12.93596
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # 3.38573
# We reject H_0 if |t_0| > t_alpha/2, n-2.
# 3.38612 > t_alpha/2, n-2
# 3.38612 > 2.101
# Therefore, reject H_0
##########################
# c) Calculate R^2
##########################
summary(m)$r.squared # 0.3891224
##########################
# d) Find a 95% Confidence Interval on the slope, B_1
##########################
# A 100(1 - alpha)% CI on B_1 is:
# B_1_hat - t_alpha/2_n-2 * se(B_1_hat) <= B_1 <= B_1_hat + t_alpha/2_n-2 * se(B_1_hat)
lower <- B_1_hat - (2.101 * SE)
lower # 4.478
upper <- B_1_hat + (2.101 * SE)
upper # 19.12
# So, the CI is: (4.478, 19.12)
##########################
# e) Find a 95% Confidence Interval on y | x_0 where x_0: x = 1
##########################
# Let dif = sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
# A 100(1 - alpha)% CI on y | x_0 where x_0 : x = 1 is:
# y_hat - dif <= y <= y_hat + dif
x_0 <- 1
B_0_hat <- 77.8633
y_hat <- B_0_hat + B_1_hat * x_0
dif <- sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
dif
lower <- y_hat - dif
lower # 88.63794
upper <- y_hat + dif
upper # 90.68866
# So, the CI is: (10.77464, 12.82536)
dif2 = (x_0 - mean(x))^2
dif2
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.7data.txt", header=T)
data
x = data$hydro
y = data$purity
##########################
# a) Fit Linear Model
##########################
m = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
m # B_0 = 77.86, B_1 = 11.80
# So y_hat = 77.86 + 11.80x
##########################
# b) Test the hypothesis that H_0 : B_1 = 0, where as H_a : B_1 /= 0
##########################
B_1_hat <- 11.80
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x - mean(x))^2)
S_xx # 1.064975
SS_res <- SS_T - B_1_hat * S_xy
n <- 20
MS_res <- SS_res / (n - 2)
MS_res #12.93596
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # 3.38573
# We reject H_0 if |t_0| > t_alpha/2, n-2.
# 3.38612 > t_alpha/2, n-2
# 3.38612 > 2.101
# Therefore, reject H_0
##########################
# c) Calculate R^2
##########################
summary(m)$r.squared # 0.3891224
##########################
# d) Find a 95% Confidence Interval on the slope, B_1
##########################
# A 100(1 - alpha)% CI on B_1 is:
# B_1_hat - t_alpha/2_n-2 * se(B_1_hat) <= B_1 <= B_1_hat + t_alpha/2_n-2 * se(B_1_hat)
lower <- B_1_hat - (2.101 * SE)
lower # 4.478
upper <- B_1_hat + (2.101 * SE)
upper # 19.12
# So, the CI is: (4.478, 19.12)
##########################
# e) Find a 95% Confidence Interval on y | x_0 where x_0: x = 1
##########################
# Let dif = sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
# A 100(1 - alpha)% CI on y | x_0 where x_0 : x = 1 is:
# y_hat - dif <= y <= y_hat + dif
x_0 <- 1
B_0_hat <- 77.8633
y_hat <- B_0_hat + B_1_hat * x_0
dif <- 2.101 * sqrt(MS_res * (1/n + (x_0 - (mean(x))^2 / S_xx)))
dif
lower <- y_hat - dif
lower # 88.63794
upper <- y_hat + dif
upper # 90.68866
# So, the CI is: (10.77464, 12.82536)
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.7data.txt", header=T)
data
x = data$hydro
y = data$purity
##########################
# a) Fit Linear Model
##########################
m = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
m # B_0 = 77.86, B_1 = 11.80
# So y_hat = 77.86 + 11.80x
##########################
# b) Test the hypothesis that H_0 : B_1 = 0, where as H_a : B_1 /= 0
##########################
B_1_hat <- 11.80
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x - mean(x))^2)
S_xx # 1.064975
SS_res <- SS_T - B_1_hat * S_xy
n <- 20
MS_res <- SS_res / (n - 2)
MS_res #12.93596
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # 3.38573
# We reject H_0 if |t_0| > t_alpha/2, n-2.
# 3.38612 > t_alpha/2, n-2
# 3.38612 > 2.101
# Therefore, reject H_0
##########################
# c) Calculate R^2
##########################
summary(m)$r.squared # 0.3891224
##########################
# d) Find a 95% Confidence Interval on the slope, B_1
##########################
# A 100(1 - alpha)% CI on B_1 is:
# B_1_hat - t_alpha/2_n-2 * se(B_1_hat) <= B_1 <= B_1_hat + t_alpha/2_n-2 * se(B_1_hat)
lower <- B_1_hat - (2.101 * SE)
lower # 4.478
upper <- B_1_hat + (2.101 * SE)
upper # 19.12
# So, the CI is: (4.478, 19.12)
##########################
# e) Find a 95% Confidence Interval on y | x_0 where x_0: x = 1
##########################
# Let dif = sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
# A 100(1 - alpha)% CI on y | x_0 where x_0 : x = 1 is:
# y_hat - dif <= y <= y_hat + dif
x_0 <- 1
B_0_hat <- 77.8633
y_hat <- B_0_hat + B_1_hat * x_0
dif <- sqrt(MS_res * (1/n + (x_0 - (mean(x))^2 / S_xx)))
dif
lower <- y_hat - dif
lower # 88.63794
upper <- y_hat + dif
upper # 90.68866
# So, the CI is: (10.77464, 12.82536)
dif <- sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
dif
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.7data.txt", header=T)
data
x = data$hydro
y = data$purity
##########################
# a) Fit Linear Model
##########################
m = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
m # B_0 = 77.86, B_1 = 11.80
# So y_hat = 77.86 + 11.80x
##########################
# b) Test the hypothesis that H_0 : B_1 = 0, where as H_a : B_1 /= 0
##########################
B_1_hat <- 11.80
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x - mean(x))^2)
S_xx # 1.064975
SS_res <- SS_T - B_1_hat * S_xy
n <- 20
MS_res <- SS_res / (n - 2)
MS_res #12.93596
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # 3.38573
# We reject H_0 if |t_0| > t_alpha/2, n-2.
# 3.38612 > t_alpha/2, n-2
# 3.38612 > 2.101
# Therefore, reject H_0
##########################
# c) Calculate R^2
##########################
summary(m)$r.squared # 0.3891224
##########################
# d) Find a 95% Confidence Interval on the slope, B_1
##########################
# A 100(1 - alpha)% CI on B_1 is:
# B_1_hat - t_alpha/2_n-2 * se(B_1_hat) <= B_1 <= B_1_hat + t_alpha/2_n-2 * se(B_1_hat)
lower <- B_1_hat - (2.101 * SE)
lower # 4.478
upper <- B_1_hat + (2.101 * SE)
upper # 19.12
# So, the CI is: (4.478, 19.12)
##########################
# e) Find a 95% Confidence Interval on y | x_0 where x_0: x = 1
##########################
# Let dif = sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
# A 100(1 - alpha)% CI on y | x_0 where x_0 : x = 1 is:
# y_hat - dif <= y <= y_hat + dif
x_0 <- 1
B_0_hat <- 77.8633
y_hat <- B_0_hat + B_1_hat * x_0
dif <- 2.101 * sqrt(MS_res * (1/n + (x_0 - mean(x))^2 / S_xx))
dif
lower <- y_hat - dif
lower # 88.63794
upper <- y_hat + dif
upper # 12.82536
# So, the CI is: (10.77464, 12.82536)
setwd("/Users/jm/Desktop/MATH 5345/")
data <- read.table("Ex2.13data.txt", header=T)
data
x = data$index
y = data$days
##########################
# a) Scatter Plot
##########################
plot(x, y, xlab="Index", ylab="Days", pch=19, main="Scatterplot of Index vs Days")
##########################
# b) Estimate the prediction equation (y = B0 + B1x)
##########################
model = lm(y~x) # Fit the model (i.e. generate coefficients for your best fit line)
model
# B_0_hat = 183.596, B_1_hat = -7.404 -----> y = 183.596 -7.404x
##########################
# c) Test for significance of the regression
##########################
# Failing to reject H_0: B_1 = 0 is equivalent to saying:
# there is no linear relationship between y and x
# Find test statistic:
B_1_hat <- -7.404
SS_T <- sum((y - mean(y))^2)
S_xy <- sum((y * (x - mean(x))))
S_xx <- sum((x - mean(x))^2)
SS_res <- SS_T - B_1_hat * S_xy
n <- 16
MS_res <- SS_res / (n - 2)
SE <- sqrt(MS_res / S_xx)
t_0 <- B_1_hat / SE
t_0 # -285.759
# Reject if |t_0| > t_alpha/2, n-2
# |-285.759| > 2.145 (t_0.05/2, 14)
# Therefore, reject H_0
##########################
# d) Calculate and plot the 95% confidence and prediction bands.
##########################
prd <- predict(model,newdata=data.frame(x=x),interval = c("confidence"),
level = 0.95,type="response")
prd
# predict.lm(model, interval="confidence")
plot(x, y, xlab="Index", ylab="Days", pch=19, main="Confidence Interval")
lines(x,prd[,1], lwd=2)
lines(x,prd[,2],col="red",lty=2)
lines(x,prd[,3],col="red",lty=2)
# A 100(1 - alpha)% CI on B_1 is:
# B_1_hat - t_alpha/2_n-2 * se(B_1_hat) <= B_1 <= B_1_hat + t_alpha/2_n-2 * se(B_1_hat)
lower <- B_1_hat - (2.145 * SE)
lower # -7.459577
upper <- B_1_hat + (2.145 * SE)
upper # -7.348423
# So, the CI is: (-7.459577, -7.348423)
